# Основные концепции

## Архитектура

`@wandry/inertia-form` построена на основе нескольких ключевых концепций:

### 1. Form Provider Pattern

Библиотека использует React Context для передачи состояния формы всем дочерним компонентам:

```tsx
<Form action="/submit" method="post" defaultValues={{ name: "" }}>
  {/* Все поля внутри получают доступ к состоянию формы */}
  <TextField name="name" label="Имя" />
  <TextField name="email" label="Email" />
</Form>
```

### 2. Controlled Components

Все поля формы являются контролируемыми компонентами, которые:

- Получают значение из состояния формы
- Отправляют изменения обратно в форму
- Автоматически обрабатывают ошибки валидации

### 3. Inertia.js Integration

Библиотека интегрируется с Inertia.js для:

- Отправки данных на сервер
- Обработки ответов и ошибок
- Управления состоянием загрузки

## Основные компоненты

### Form

Основной компонент, который:

- Создает контекст формы
- Управляет отправкой данных
- Предоставляет состояние всем дочерним компонентам

### Field Components

Готовые компоненты для типовых полей:

- `TextField` - текстовые поля
- `SelectField` - выпадающие списки
- `CheckboxField` - чекбоксы
- `TextareaField` - многострочные поля

### Field (Base Component)

Базовый компонент для создания кастомных полей с полным контролем над рендерингом.

## Хуки

### useFormContext

Предоставляет доступ к:

- Значениям формы
- Ошибкам валидации
- Методам управления формой
- Состоянию загрузки

### useWatch

Позволяет отслеживать изменения конкретных полей для условной логики.

## Жизненный цикл формы

1. **Инициализация** - форма создается с `defaultValues`
2. **Ввод данных** - пользователь взаимодействует с полями
3. **Валидация** - проверка данных (клиентская и серверная)
4. **Отправка** - данные отправляются на сервер через Inertia.js
5. **Обработка ответа** - обработка успеха или ошибок
6. **Сброс** - возврат к начальному состоянию (опционально)

## Обработка ошибок

Ошибки могут приходить с сервера в формате:

```json
{
  "errors": {
    "name": ["Поле обязательно для заполнения"],
    "email": ["Неверный формат email"]
  }
}
```

Библиотека автоматически:

- Отображает ошибки рядом с соответствующими полями
- Подсвечивает поля с ошибками
- Показывает общие ошибки формы

## Типизация

Библиотека полностью типизирована с TypeScript:

```tsx
interface FormData {
  name: string;
  email: string;
  agree: boolean;
}

<Form<FormData>
  action="/submit"
  method="post"
  defaultValues={{ name: "", email: "", agree: false }}
>
  <TextField name="name" label="Имя" />
  <TextField name="email" label="Email" />
  <CheckboxField name="agree" label="Согласен" />
</Form>;
```

## Стилизация

Компоненты используют:

- **Tailwind CSS** для базовых стилей
- **Radix UI** для доступности и поведения
- **class-variance-authority** для вариантов стилей
- **clsx** и **tailwind-merge** для условных классов

Все стили можно кастомизировать через CSS-классы или переопределить полностью.

## Производительность

Библиотека оптимизирована для производительности:

- Минимальные ре-рендеры благодаря React Context
- Ленивая загрузка компонентов
- Эффективное обновление состояния
- Оптимизированные хуки для отслеживания изменений
